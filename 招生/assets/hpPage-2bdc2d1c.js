import{V as L}from"./index-513bbaed.js";import{_ as G,r as y,d as o,a as s,c as r,e as u,O as U,P as Q,Q as Z,b as f,w as c,g as z,R as M,p as E,s as W,o as q,k as A,v as H,K as N,M as R,t as D,H as i,z as j,V as $,N as w,B as ee}from"./index-987701ae.js";/* empty css              */import{m as te}from"./index-3b04c4a4.js";import{p as V,e as ae,j as oe,g as se,f as ne}from"./api-e1e47605.js";import{C as le}from"./index-189cdbbf.js";const ie={setup(){const b=y();b.value=o.rowschool.value.subjectType;const d=y();d.value=o.rowschool.value.planned_number;const p=y();return p.value=o.rowschool.value.zybz,{data1:p,planned_number:d,subjectType:b,stusure:async()=>{var n;const S=document.getElementById("kl").value,m=document.getElementById("planNumber").value;var I=document.querySelector(".layui-textarea").value;const k={PPid:o.stuppid,subjectType:S,Zybz:I,planned_number:parseInt(m),transcribe:1};if(m===""||m==0||m<0)M.msg("拟计划数不能输入为0或小于0");else if((m>o.oanumber*1.2||m<o.oanumber*.8)&&o.abnormal==0)M.msg("拟计划数异常 请上传证明材料");else if(I.length>50)M.msg("备注不能超过50字");else{console.log(k);const C=W.supapi+"/api/SecondaryEnrollment/updataprofessionalplan",x={method:"POST",headers:{Authorization:"Bearer "+(((n=JSON.parse(localStorage.getItem("taken")))==null?void 0:n.accessToken)||o.takel.accessToken),"content-type":"application/json"},body:JSON.stringify(k)};fetch(C,x).then(_=>_.json()).then(_=>{M.msg(_.message),console.log(_),V.api()}).then(_=>{console.log(_)})}}}}},ce={class:"all1box"},de={class:"xiubox2"},re=u("span",null,"科类",-1),ue=u("option",{value:"0"},"初中",-1),pe=u("option",{value:"1"},"高中文科",-1),me=u("option",{value:"5"},"高中理科",-1),_e=[ue,pe,me],he={class:"xiubox2"},ye=u("span",null,"计划数",-1),be={class:"xiubox2"},Ie=u("span",null,"专业备注",-1);function ke(b,d,p,a,S,m){const I=le,k=E;return s(),r("div",ce,[u("div",de,[re,U(u("select",{id:"kl","onUpdate:modelValue":d[0]||(d[0]=n=>a.subjectType=n)},_e,512),[[Q,a.subjectType]])]),u("div",he,[ye,U(u("input",{"onUpdate:modelValue":d[1]||(d[1]=n=>a.planned_number=n),id:"planNumber",type:"number",max:"300",min:"0"},null,512),[[Z,a.planned_number]])]),u("div",be,[Ie,f(I,{id:"ni",placeholder:"请输入描述",modelValue:a.data1,"onUpdate:modelValue":d[2]||(d[2]=n=>a.data1=n)},null,8,["modelValue"])]),f(k,{style:{display:"flex",margin:"0 auto"},border:"green",onClick:a.stusure},{default:c(()=>[z("确定")]),_:1},8,["onClick"])])}const ve=G(ie,[["render",ke]]);const ge={setup(){const b=o.school.value.userId||(JSON.parse(localStorage.getItem("schooll"))||{}).userId||"无",d=o.school.value.schoolName||(JSON.parse(localStorage.getItem("schooll"))||{}).schoolName||"无",p=y([]),a=async(t,h)=>{ae.api(t,h)},S=async t=>{N.confirm(t.auditRemark)},m=async()=>{const t=[];o.stuootcity.value.forEach(h=>{t.push(h.ppid)}),console.log(t),oe.api(t),V.api()},I=function(t){o.oanumber=t.orginal_plan_number,o.abnormal=t.abnormal,o.stuppid=t.ppid,o.rowschool.value=t,N.open({type:"page",title:"修改相关信息",content:R(ve)})},k=async t=>{se.api(t),V.api()},n=async t=>{ne.api(t),V.api()},C=async()=>{},x=async()=>{var v;const t=W.supapi+"/api/SecondaryEnrollment/getprofessionalplans?transcribe=1",h={method:"GET",headers:{Authorization:"Bearer "+(((v=JSON.parse(localStorage.getItem("taken")))==null?void 0:v.accessToken)||o.takel.accessToken)}};try{const J=await(await fetch(t,h)).json();o.stuone.value=J.data,p.value=o.stuone.value,console.log(p.value),o.stuootcity.value=[],p.value.forEach(g=>{(g.state==0||g.state==3)&&o.stuootcity.value.push(g)})}catch(T){console.log("数据获取失败",T)}};q(()=>{x()}),A(o.stuone,()=>{p.value==o.stuone.value?console.log("一样的"):x()},{immediate:!0});const _=y([{value:1,label:"",closable:!1}]),e=y(""),l=y(!1),O=y([]),Y=H({current:1,limit:10,total:100}),B=y([{title:"专业代码",width:"50",key:"spmcode",fixed:"left",sort:"desc"},{title:"专业名称",width:"50",key:"spmname",sort:"desc"},{title:"科类",width:"50",key:"subjectType",customSlot:"subjectType"},{title:"专业备注",width:"50",key:"zybz",customSlot:"zybz"},{title:"原计划数",width:"50",key:"orginal_plan_number"},{title:"拟计划数",width:"50",key:"planned_number"},{title:"状态",width:"50",key:"state",customSlot:"word3"},{title:"操作",width:"50",customSlot:"operator",key:"operator",fixed:"right",ignoreExport:!0}]),X=t=>{l.value=!0,setTimeout(()=>{p.value=P(t.current,t.limit),l.value=!1},1e3)},F=(t,h)=>{p.value.forEach(v=>{v.id===h.id&&N.msg("Success",{icon:1},()=>{v.status=t})})},K=()=>{N.msg(O.value,{area:"50%"})},P=(t,h)=>{for(var v=[],T=(t-1)*h+1,J=t*h,g=T;g<=J;g++)v.push({id:`${g}`,age:"18",sex:"男",name:`张三${g}`,email:"test@qq.com",remark:"花开堪折直须折,莫待无花空折枝.",joinTime:"2022-02-09",city:"浙江杭州",status:!0});return v};return{allshenbao:m,allshen:C,id:b,name:d,chakan:S,handleFileUpload:a,openConfirm:I,shenbao:n,del:k,data1:_,inputValue1:e,columns:B,dataSource:p,selectedKeys:O,page:Y,change:X,changeStatus:F,remove:K}}},fe={class:"container-demo"},xe={class:"scroll-container1"},ze={class:"scroll-contentll"},Ce={key:0,size:"xs",type:"primary",style:{"text-align":"center"}},je={key:0,id:"WcCc0",style:{color:"rgb(123, 123, 123)"}},Se={key:1,id:"WcCc1",style:{color:"rgb(36, 135, 255)"}},Te={key:2,id:"WcCc2",style:{color:"rgb(26,188,156)"}},Me={key:3,id:"WcCc3",style:{color:"rgb(248, 50, 10)"}},Ne={key:4,id:"WcCc4",style:{color:"rgb(36, 135, 255)"}},Ve={key:5,id:"WcCc5",style:{color:"rgb(0, 0, 0)"}},Je={key:0,id:"WcCc0"},Oe={key:1,id:"WcCc1"},Ue={key:2,id:"WcCc1"},De={key:0},Ge={key:1};function Ee(b,d,p,a,S,m){const I=te,k=$,n=E,C=w,x=ee,_=L;return s(),r("div",fe,[f(I,{theme:"green"},{title:c(()=>[z(" 欢迎:"+D(a.name),1)]),_:1}),u("div",xe,[u("div",ze,[f(_,{resize:!1,height:"90%",columns:a.columns,loading:b.loading,"default-toolbar":!0,"data-source":a.dataSource,"selected-keys":a.selectedKeys,"onUpdate:selectedKeys":d[0]||(d[0]=e=>a.selectedKeys=e),onChange:a.change,onSortChange:b.sortChange},{date:c(({row:e})=>[]),status:c(({row:e})=>[f(k,{"model-value":e.status,onChange:l=>a.changeStatus(l,e)},null,8,["model-value","onChange"])]),toolbar:c(()=>[f(n,{size:"sm",type:"primary",onClick:a.allshenbao},{default:c(()=>[z("提交申报")]),_:1},8,["onClick"])]),operator:c(({row:e})=>[e.state==1||e.state==2||e.state==4||e.state==5?(s(),r("p",Ce,"暂不可操作")):i("",!0),e.state===0||e.state===3?(s(),j(n,{key:1,size:"xs",type:"primary",onClick:l=>a.shenbao(e)},{default:c(()=>[z("申报")]),_:2},1032,["onClick"])):i("",!0),e.state===0||e.state===3?(s(),j(n,{key:2,size:"xs",onClick:l=>a.openConfirm(e)},{default:c(()=>[z("修改")]),_:2},1032,["onClick"])):i("",!0),e.state===0||e.state===3?(s(),j(n,{key:3,size:"xs",onClick:l=>a.del(e)},{default:c(()=>[z("删除")]),_:2},1032,["onClick"])):i("",!0),e.state==3?(s(),j(n,{key:4,size:"xs",onClick:l=>a.chakan(e)},{default:c(()=>[z("查看原因")]),_:2},1032,["onClick"])):i("",!0),e.abnormal==0&&(e.state==0||e.state==3)?(s(),j(C,{key:5,multiple:!0,size:10240,text:"上传文件",acceptMime:"application/pdf",style:{"margin-left":"10px"},headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIzOTc1IiwibmFtZSI6IjE0MzkzIiwidXNlcmlkIjoiMzk3NSIsImFjY291bnQiOiIxNDM5MyIsInVzZXJ0eXBlIjoiMCIsImVtaWFsIjoiIiwicGhvbmUiOiIiLCJzY2hvb2x0eXBlIjoiMSIsInNjaG9vbG5hbWUiOiLlt53ljJflubzlhL_luIjojIPpq5jnrYnkuJPnp5HlrabmoKEiLCJuYmYiOjE2OTk3NTUxMDMsImV4cCI6MTczMTI5MTEwMywiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDY1IiwiYXVkIjoiSFNDbGllbnQifQ.5G_Q4leGvJ7SWzh9AgKOv_nqGpSfUJizukSUKZ0CZ70"},data:e.ddird,onDone:l=>a.handleFileUpload(l,e)},null,8,["headers","data","onDone"])):i("",!0),e.abnormal==2&&(e.state==0||e.state==3)?(s(),j(C,{key:6,multiple:!0,size:10240,text:"重新上传",acceptMime:"application/pdf",style:{"margin-left":"10px"},headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIzOTc1IiwibmFtZSI6IjE0MzkzIiwidXNlcmlkIjoiMzk3NSIsImFjY291bnQiOiIxNDM5MyIsInVzZXJ0eXBlIjoiMCIsImVtaWFsIjoiIiwicGhvbmUiOiIiLCJzY2hvb2x0eXBlIjoiMSIsInNjaG9vbG5hbWUiOiLlt53ljJflubzlhL_luIjojIPpq5jnrYnkuJPnp5HlrabmoKEiLCJuYmYiOjE2OTk3NTUxMDMsImV4cCI6MTczMTI5MTEwMywiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDY1IiwiYXVkIjoiSFNDbGllbnQifQ.5G_Q4leGvJ7SWzh9AgKOv_nqGpSfUJizukSUKZ0CZ70"},data:e.ddird,onDone:l=>a.handleFileUpload(l,e)},null,8,["headers","data","onDone"])):i("",!0)]),word3:c(({row:e})=>[e.state===0?(s(),r("p",je," 待提交 ")):i("",!0),e.state===1?(s(),r("p",Se," 审核中 ")):i("",!0),e.state===2?(s(),r("p",Te," 待核对 ")):i("",!0),e.state===3?(s(),r("p",Me," 已退回 ")):i("",!0),e.state===4?(s(),r("p",Ne," 待定稿 ")):i("",!0),e.state===5?(s(),r("p",Ve," 已定稿 ")):i("",!0)]),subjectType:c(({row:e})=>[e.subjectType==0?(s(),r("p",Je," 初中 ")):i("",!0),e.subjectType==1?(s(),r("p",Oe," 高中文科 ")):i("",!0),e.subjectType==5?(s(),r("p",Ue," 高中理科 ")):i("",!0)]),zybz:c(({row:e})=>[e.zybz==null?(s(),r("p",De,"无")):(s(),r("p",Ge,D(e.zybz),1))]),Input1:c(({row:e})=>[f(x,{modelValue:e.orginal_plan_number,"onUpdate:modelValue":l=>e.orginal_plan_number=l,placeholder:"请输入",style:{width:"180px"}},null,8,["modelValue","onUpdate:modelValue"])]),Input2:c(({row:e})=>[f(x,{modelValue:e.planned_number,"onUpdate:modelValue":l=>e.planned_number=l,placeholder:"请输入",style:{width:"180px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["columns","loading","data-source","selected-keys","onChange","onSortChange"])])])])}const Pe=G(ge,[["render",Ee]]);export{Pe as default};
