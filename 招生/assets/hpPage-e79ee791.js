import{V as A}from"./index-513bbaed.js";import{_ as F,r as p,d as n,a as i,c as r,e as o,O as N,P as G,Q as Y,b as g,w as u,g as k,K as _,p as K,s as P,S as L,k as Q,o as H,v as Z,M as q,t as X,H as d,z as M,V as R,N as w,B as $}from"./index-987701ae.js";/* empty css              */import{m as ee}from"./index-3b04c4a4.js";import{C as te}from"./index-189cdbbf.js";import{m as T,e as oe,j as se,g as le,f as ne}from"./api-e1e47605.js";const ae={setup(){const m=p();m.value=n.rowschool.value.zybz;const c=p();c.value=n.rowschool.value.zslbdm;const z=p();z.value=n.rowschool.value.subjectType;const t=p();t.value=n.rowschool.value.xxxsdm;const f=p();f.value=n.rowschool.value.schoolSystem;const S=p();S.value=n.rowschool.value.planned_number;const y=p();return y.value=n.rowschool.value.tuition,{planNumber:S,xxxsdm:t,tuition:y,schoolSystem:f,kl:z,zslbdm:c,data1:m,stusure:async()=>{var O;const s=document.getElementById("tuition").value,j=document.getElementById("zslbdm").value,V=document.getElementById("xxxsdm").value,x=document.getElementById("schoolSystem").value,e=document.getElementById("kl").value,a=document.getElementById("planNumber").value;var J=document.querySelector(".layui-textarea").value;const U={PPid:n.stuppid,tuition:s,zslbdm:j,xxxsdm:V,schoolSystem:x,subjectType:e,planned_number:a,zybz:J};if(console.log(U),a===""||a==0)_.msg("拟计划数不能输入为0");else if(s<0||s==""||s==0)_.msg("学费异常 请重新输入");else if(x<0||x==""||x==0)_.msg("学制异常 请重新输入");else if(a<0)_.msg("拟计划数不能小于0");else if((a>n.oanumber*1.2||a<n.oanumber*.8)&&n.abnormal==0)_.msg("拟计划数异常 请上传证明材料");else if(J.length>50)_.msg("备注不能超过50字");else{const D=P.supapi+"/api/SecondaryEnrollment/updataprofessionalplan",W={method:"POST",headers:{Authorization:"Bearer "+(((O=JSON.parse(localStorage.getItem("taken")))==null?void 0:O.accessToken)||n.takel.accessToken),"content-type":"application/json"},body:JSON.stringify(U)};fetch(D,W).then(b=>b.json()).then(b=>{_.msg(b.message),console.log(b),T.api()}).then(b=>{console.log(b)})}}}}},ie={class:"all1box"},ce={class:"xiubox2"},de=o("span",null,"招生类别",-1),ue=L('<option value="1">五年制高职（师范类）</option><option value="2">五年制高职（非师范类）</option><option value="3">中职（非师范类）</option><option value="4">中职（非师范类）</option><option value="5">职高（师范类）</option><option value="6">职高（非师范类） </option><option value="7">技工学校</option>',7),re=[ue],me={class:"xiubox2"},pe=o("span",null,"科类",-1),_e=o("option",{value:"0"},"初中",-1),he=o("option",{value:"1"},"高中文科",-1),ye=o("option",{value:"5"},"高中理科",-1),xe=[_e,he,ye],be={class:"xiubox2"},ve=o("span",null,"学习形式",-1),Ie=o("option",{value:"1"},"脱产",-1),ke=o("option",{value:"2"},"业余",-1),ge=o("option",{value:"3"},"函授",-1),ze=[Ie,ke,ge],fe={class:"xiubox2"},Se=o("span",null,"学制",-1),Ce={class:"xiubox2"},je=o("span",null,"计划数",-1),Ve={class:"xiubox2"},Ne=o("span",null,"学费",-1),Me={class:"xiubox2"},Te=o("span",null,"专业备注",-1);function Je(m,c,z,t,f,S){const y=te,C=K;return i(),r("div",ie,[o("div",ce,[de,N(o("select",{id:"zslbdm","onUpdate:modelValue":c[0]||(c[0]=s=>t.zslbdm=s)},re,512),[[G,t.zslbdm]])]),o("div",me,[pe,N(o("select",{id:"kl","onUpdate:modelValue":c[1]||(c[1]=s=>t.kl=s)},xe,512),[[G,t.kl]])]),o("div",be,[ve,N(o("select",{id:"xxxsdm","onUpdate:modelValue":c[2]||(c[2]=s=>t.xxxsdm=s)},ze,512),[[G,t.xxxsdm]])]),o("div",fe,[Se,N(o("input",{"onUpdate:modelValue":c[3]||(c[3]=s=>t.schoolSystem=s),id:"schoolSystem",type:"number",max:"300",min:"100"},null,512),[[Y,t.schoolSystem]])]),o("div",Ce,[je,N(o("input",{"onUpdate:modelValue":c[4]||(c[4]=s=>t.planNumber=s),id:"planNumber",type:"number",max:"300",min:"100"},null,512),[[Y,t.planNumber]])]),o("div",Ve,[Ne,N(o("input",{"onUpdate:modelValue":c[5]||(c[5]=s=>t.tuition=s),id:"tuition",type:"number",max:"300",min:"100"},null,512),[[Y,t.tuition]])]),o("div",Me,[Te,g(y,{id:"ni",placeholder:"请输入描述",modelValue:t.data1,"onUpdate:modelValue":c[6]||(c[6]=s=>t.data1=s)},null,8,["modelValue"])]),g(C,{style:{display:"flex",margin:"0 auto"},border:"green",onClick:t.stusure},{default:u(()=>[k("确定")]),_:1},8,["onClick"])])}const Ue=F(ae,[["render",Je]]);const Oe={setup(){const m=p([]),c=n.school.value.userId||(JSON.parse(localStorage.getItem("schooll"))||{}).userId||"无",z=n.school.value.schoolName||(JSON.parse(localStorage.getItem("schooll"))||{}).schoolName||"无",t=async(l,h)=>{oe.api(l,h),T.api()},f=async l=>{_.confirm(l.auditRemark)},S=async()=>{const l=[];n.stuHcity.value.forEach(h=>{l.push(h.ppid)}),console.log(l),se.api(l),T.api()},y=async l=>{le.api(l),T.api()},C=async l=>{ne.api(l),console.log(l),T.api()},s=async()=>{var v;const l=P.supapi+"/api/SecondaryEnrollment/getprofessionalplans?transcribe=4",h={method:"GET",headers:{Authorization:"Bearer "+(((v=JSON.parse(localStorage.getItem("taken")))==null?void 0:v.accessToken)||n.takel.accessToken)}};try{const B=await(await fetch(l,h)).json();n.stuAll.value=B.data,m.value=n.stuAll.value,n.stuHcity.value=[],m.value.forEach(I=>{(I.state==0||I.state==3)&&n.stuHcity.value.push(I)})}catch(E){console.log("数据获取失败：",E)}};Q(n.stuAll,()=>{m.value==n.stuAll.value?console.log("一样的"):s()},{immediate:!0});const j=function(l){n.rowschool.value=l,n.oanumber=l.orginal_plan_number,n.abnormal=l.abnormal,n.stuppid=l.ppid,_.open({type:"page",title:"修改相关信息",content:q(Ue)})};H(()=>{s()});const V=p([{value:1,label:"",closable:!1}]),x=p(""),e=p(!1),a=p([]),J=Z({current:1,limit:10,total:100}),U=p([{title:"专业代码",width:"50",key:"spmcode",sort:"desc"},{title:"专业名称",width:"50",key:"spmname"},{title:"招生类别",width:"50",key:"zslbdm"},{title:"科类",width:"50",key:"subjectType",customSlot:"subjectType"},{title:"学习形式",width:"50",key:"xxxsdm",customSlot:"xxxsdm"},{title:"学制",width:"50",key:"schoolSystem",customSlot:"schoolSystem"},{title:"学费",width:"50",key:"tuition"},{title:"原计划数",width:"50",key:"orginal_plan_number"},{title:"拟计划数",width:"50",key:"planned_number"},{title:"专业备注",width:"50",key:"zybz",customSlot:"zybz"},{title:"状态",width:"50",key:"state",customSlot:"word3"},{title:"操作",width:"50",customSlot:"operator",key:"operator",fixed:"right",ignoreExport:!0}]),O=l=>{e.value=!0,setTimeout(()=>{m.value=b(l.current,l.limit),e.value=!1},1e3)},D=(l,h)=>{m.value.forEach(v=>{v.id===h.id&&_.msg("Success",{icon:1},()=>{v.status=l})})},W=()=>{_.msg(a.value,{area:"50%"})},b=(l,h)=>{for(var v=[],E=(l-1)*h+1,B=l*h,I=E;I<=B;I++)v.push({id:`${I}`,age:"18",sex:"男",name:`张三${I}`,email:"test@qq.com",remark:"花开堪折直须折,莫待无花空折枝.",joinTime:"2022-02-09",city:"浙江杭州",status:!0});return v};return{id:c,name:z,chakan:f,handleFileUpload:t,allshenbao:S,del:y,shenbao:C,openConfirm:j,data1:V,inputValue1:x,columns:U,dataSource:m,selectedKeys:a,page:J,change:O,changeStatus:D,remove:W}}},Ee={class:"container-demo"},De={class:"scroll-container11"},We={class:"scroll-content1"},Be={key:0,id:"WcCc0",style:{color:"rgb(123, 123, 123)"}},Ge={key:1,id:"WcCc1",style:{color:"rgb(36, 135, 255)"}},Ye={key:2,id:"WcCc2",style:{color:"rgb(26,188,156)"}},Xe={key:3,id:"WcCc3",style:{color:"rgb(248, 50, 10)"}},Fe={key:4,id:"WcCc4",style:{color:"rgb(36, 135, 255)"}},Ke={key:5,id:"WcCc5",style:{color:"rgb(0, 0, 0)"}},Pe={key:0,id:"WcCc0"},Ae={key:1,id:"WcCc1"},Le={key:2,id:"WcCc1"},Qe={key:0,id:"WcCc0"},He={key:1,id:"WcCc1"},Ze={key:2,id:"WcCc1"},qe={key:0},Re={key:1},we={key:0,size:"xs",type:"primary",style:{"text-align":"center"}};function $e(m,c,z,t,f,S){const y=ee,C=R,s=K,j=w,V=$,x=A;return i(),r("div",Ee,[g(y,{theme:"green"},{title:u(()=>[k(" 欢迎:"+X(t.name),1)]),_:1}),o("div",De,[o("div",We,[g(x,{resize:!1,height:"90%",columns:t.columns,loading:m.loading,"default-toolbar":!0,"data-source":t.dataSource,"selected-keys":t.selectedKeys,"onUpdate:selectedKeys":c[0]||(c[0]=e=>t.selectedKeys=e),onChange:t.change,onSortChange:m.sortChange},{date:u(({row:e})=>[]),status:u(({row:e})=>[g(C,{"model-value":e.status,onChange:a=>t.changeStatus(a,e)},null,8,["model-value","onChange"])]),toolbar:u(()=>[g(s,{size:"sm",type:"primary",onClick:t.allshenbao},{default:u(()=>[k("提交申报")]),_:1},8,["onClick"])]),schoolSystem:u(({row:e})=>[k(X(e.schoolSystem)+"年 ",1)]),word3:u(({row:e})=>[e.state===0?(i(),r("p",Be," 待提交 ")):d("",!0),e.state===1?(i(),r("p",Ge," 审核中 ")):d("",!0),e.state===2?(i(),r("p",Ye," 待核对 ")):d("",!0),e.state===3?(i(),r("p",Xe," 已退回 ")):d("",!0),e.state===4?(i(),r("p",Fe," 待定稿 ")):d("",!0),e.state===5?(i(),r("p",Ke," 已定稿 ")):d("",!0)]),xxxsdm:u(({row:e})=>[e.xxxsdm==1?(i(),r("p",Pe," 脱产 ")):d("",!0),e.xxxsdm==2?(i(),r("p",Ae," 业余 ")):d("",!0),e.xxxsdm==3?(i(),r("p",Le," 函授 ")):d("",!0)]),subjectType:u(({row:e})=>[e.subjectType==0?(i(),r("p",Qe," 初中 ")):d("",!0),e.subjectType==1?(i(),r("p",He," 高中文科 ")):d("",!0),e.subjectType==5?(i(),r("p",Ze," 高中理科 ")):d("",!0)]),zybz:u(({row:e})=>[e.zybz==null?(i(),r("p",qe,"无")):(i(),r("p",Re,X(e.zybz),1))]),operator:u(({row:e})=>[e.state==1||e.state==2||e.state==4||e.state==5?(i(),r("p",we,"暂不可操作")):d("",!0),e.state===0||e.state===3?(i(),M(s,{key:1,size:"xs",type:"primary",onClick:a=>t.shenbao(e)},{default:u(()=>[k("申报")]),_:2},1032,["onClick"])):d("",!0),e.state===0||e.state===3?(i(),M(s,{key:2,size:"xs",onClick:a=>t.openConfirm(e)},{default:u(()=>[k("修改")]),_:2},1032,["onClick"])):d("",!0),e.state==3?(i(),M(s,{key:3,size:"xs",onClick:a=>t.chakan(e)},{default:u(()=>[k("查看原因")]),_:2},1032,["onClick"])):d("",!0),e.state===0||e.state===3?(i(),M(s,{key:4,size:"xs",onClick:a=>t.del(e)},{default:u(()=>[k("删除")]),_:2},1032,["onClick"])):d("",!0),e.abnormal==0&&(e.state==0||e.state==3)?(i(),M(j,{key:5,multiple:!0,size:10240,text:"上传文件",acceptMime:"application/pdf",style:{"margin-left":"10px"},headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIzOTc1IiwibmFtZSI6IjE0MzkzIiwidXNlcmlkIjoiMzk3NSIsImFjY291bnQiOiIxNDM5MyIsInVzZXJ0eXBlIjoiMCIsImVtaWFsIjoiIiwicGhvbmUiOiIiLCJzY2hvb2x0eXBlIjoiMSIsInNjaG9vbG5hbWUiOiLlt53ljJflubzlhL_luIjojIPpq5jnrYnkuJPnp5HlrabmoKEiLCJuYmYiOjE2OTk3NTUxMDMsImV4cCI6MTczMTI5MTEwMywiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDY1IiwiYXVkIjoiSFNDbGllbnQifQ.5G_Q4leGvJ7SWzh9AgKOv_nqGpSfUJizukSUKZ0CZ70"},data:e.ddird,onDone:a=>t.handleFileUpload(a,e)},null,8,["headers","data","onDone"])):d("",!0),e.abnormal==2&&(e.state==0||e.state==3)?(i(),M(j,{key:6,multiple:!0,size:10240,text:"重新上传",acceptMime:"application/pdf",style:{"margin-left":"10px"},headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIzOTc1IiwibmFtZSI6IjE0MzkzIiwidXNlcmlkIjoiMzk3NSIsImFjY291bnQiOiIxNDM5MyIsInVzZXJ0eXBlIjoiMCIsImVtaWFsIjoiIiwicGhvbmUiOiIiLCJzY2hvb2x0eXBlIjoiMSIsInNjaG9vbG5hbWUiOiLlt53ljJflubzlhL_luIjojIPpq5jnrYnkuJPnp5HlrabmoKEiLCJuYmYiOjE2OTk3NTUxMDMsImV4cCI6MTczMTI5MTEwMywiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDY1IiwiYXVkIjoiSFNDbGllbnQifQ.5G_Q4leGvJ7SWzh9AgKOv_nqGpSfUJizukSUKZ0CZ70"},data:e.ddird,onDone:a=>t.handleFileUpload(a,e)},null,8,["headers","data","onDone"])):d("",!0)]),Input1:u(({row:e})=>[g(V,{modelValue:e.orginal_plan_number,"onUpdate:modelValue":a=>e.orginal_plan_number=a,placeholder:"请输入",style:{width:"180px"}},null,8,["modelValue","onUpdate:modelValue"])]),Input2:u(({row:e})=>[g(V,{modelValue:e.planned_number,"onUpdate:modelValue":a=>e.planned_number=a,placeholder:"请输入",style:{width:"180px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["columns","loading","data-source","selected-keys","onChange","onSortChange"])])])])}const at=F(Oe,[["render",$e]]);export{at as default};
